CREATE VIEW `schools_by_major_presentasi_grab` AS
SELECT
    schools.id AS id,
    schools.region AS wilayah,
    schools.name AS nama,
    SUM(CASE WHEN applicants.source_id = 1 THEN 1 ELSE 0 END) AS website,
    SUM(CASE WHEN applicants.source_id = 2 THEN 1 ELSE 0 END) AS mgm,
    SUM(CASE WHEN applicants.source_id = 3 THEN 1 ELSE 0 END) AS sosmed,
    SUM(CASE WHEN applicants.source_id = 4 THEN 1 ELSE 0 END) AS sekolah,
    SUM(CASE WHEN applicants.source_id = 5 THEN 1 ELSE 0 END) AS jadwaldatang,
    SUM(CASE WHEN applicants.source_id = 6 THEN 1 ELSE 0 END) AS gurubk,
    SUM(CASE WHEN applicants.source_id = 7 THEN 1 ELSE 0 END) AS presentasi,
    SUM(CASE WHEN applicants.source_id = 8 THEN 1 ELSE 0 END) AS daftaronline,
    SUM(CASE WHEN applicants.source_id = 9 THEN 1 ELSE 0 END) AS grab,
    SUM(CASE WHEN applicants.source_id = 10 THEN 1 ELSE 0 END) AS beasiswa,
    COUNT(DISTINCT applicants.major) AS kelas,
    COUNT(applicants.major) AS jumlah
FROM
    schools
LEFT JOIN
    applicants ON schools.id = applicants.school
GROUP BY
    schools.id, schools.region, schools.name;
